<html ng-app="broadcastService">
<head>
<title>Broadcast Service</title>
<meta name="viewport" content="width=device-width">
<link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js" type="text/javascript"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js" type="text/javascript"></script>
<style type="text/css">
  /* Space out content a bit */
  body {
    padding-top: 20px;
    padding-bottom: 20px;
  }
</style>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/0.9.16/socket.io.min.js"></script>
<script>

var socket = io.connect('http://localhost:3000');
var app = angular.module('broadcastService', []);
app.controller('broadcastServiceController', function($scope) {
    $scope.pesanDiterima = []
    $scope.content = "";
    $scope.destination = "";
    $scope.sendMessage = function() {
        socket.emit('sendMessage', {content: $scope.content, destination: $scope.destination}, function(err) {
            if(err) {
                alert('Some error may happened. Try again.')
            } else {
                alert('Your message was processed');
                $scope.content = "";
                $scope.destination = "";
            }
        });

    }
    socket.on('retrieveNewMessage', function(data) {
        $scope.pesanDiterima.push(data);
    });
})
</script>
</head>
<body ng-controller="broadcastServiceController">
<div class="container">
  <div class="header">
    <h3 class="text-muted">Broadcast Service</h3>
  </div>

  <div class="row">
    <div class="col-lg-12">
        <div class="form-group">
            <label class="control-label">Content</label>
            <div class="controls"><input type="text" class="form-control" ng-model="content" /></div>
        </div>
        <div class="form-group">
            <label class="control-label">Destination IP</label>
            <div class="controls"><input type="text" class="form-control" ng-model="destination" /></div>
        </div>
        <button ng-click="sendMessage()" class="btn">Send</button>
        <h3>Pesan diterima</h3>
        <ul ng-repeat="item in pesanDiterima">
            <li>{{item.content}}</li>
        </ul>
    </div>
  </div>

  <div class="footer">
    <p>&copy; Suli dan Wira 2014</p>
  </div>

</div> <!-- /container -->
</body>
</html>
